# Документація Makefile

## Огляд
Цей Makefile спрощує автоматизацію різноманітних завдань у проекті, таких як управління Docker контейнерами, виконання команд Composer та управління консольними командами Symfony.

## Команда налаштування
Перед початком роботи над проектом виконайте команду налаштування, щоб забезпечити наявність необхідних конфігураційних файлів:

    make setup
Ця команда перевіряє наявність і копіює `.env.local` та `MakefileCustom` з їх `.dist` версій, якщо вони не існують.

## Команди управління Docker
- `make up` – Запускає всі контейнери.
- `make up-d` – Запускає всі контейнери у фоновому режимі.
- `make up-b` – Перебудовує та запускає контейнери.
- `make up-r` – Примусово перестворює та запускає контейнери.
- `make down` – Зупиняє контейнери та видаляє осиротілі об'єкти.

## Команди Composer
- `make composer-install`, `make composer-i` – Встановлює необхідні залежності проекту.
- `make composer-update`, `make composer-u` – Оновлює залежності проекту до останніх версій.

## Розширення функціональності за допомогою MakefileCustom
Для розширення або зміни функціональності Makefile без зміни основного файлу використовуйте `MakefileCustom`. Цей підхід допомагає підтримувати основний Makefile чистим, дозволяючи кастомні модифікації.

#### Додавання кастомних команд
- `make test` – Виконує кастомні тестові сценарії.
```
test: CMD = test
test: composer
```
- `make debug-config` – Виводить інформацію для відладки конфігурації. (Визначення: `` ``)
```
debug-config: EXEC = debug:config
debug-config: console
```

### Змінні для автоматизації команд

У `Makefile` використовуються змінні для спрощення викликів команд та забезпечення консистентності управління середовищами. Змінна `DOCKER_COMPOSE` визначає команду для управління Docker контейнерами, використовуючи файл налаштувань `.env.local`, що дозволяє забезпечити необхідні налаштування для різних середовищ:

```makefile
DOCKER_COMPOSE = docker-compose --env-file .env.local
```
Змінна `DOCKER_EXEC` використовується для виконання команд у контейнері `php_$(PROJECT_NAME)`, де `$(PROJECT_NAME)` є змінною, що зазначає назву проекту, і забезпечує універсальність команд для різних проектів:

```makefile
DOCKER_EXEC = docker exec -it php_$(PROJECT_NAME) /bin/bash -c
```
Ці змінні дозволяють будувати інші команди, що використовуються в Makefile, наприклад, для запуску Symfony консольних команд чи Composer:

```makefile
composer: 
    $(DOCKER_EXEC) "composer $(CMD)"
```
Такий підхід дозволяє централізувати конфігурацію команд і легко адаптувати Makefile до змін у проекті чи середовищі без потреби змінювати кожну команду окремо.

### Застереження
Переконайтеся, що всі модифікації слідують встановленому формату та конвенціям, які використовуються в основному Makefile, для забезпечення консистентності та функціональності.
